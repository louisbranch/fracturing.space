// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import (
	"github.com/a-h/templ"
	templruntime "github.com/a-h/templ/runtime"
)

// LoginParams holds values for the sign-in page.
type LoginParams struct {
	AppName    string
	PendingID  string
	ClientName string
	Error      string
	Lang       string
	Loc        Localizer
}

// LoginPage renders the passkey sign-in / registration page.
func LoginPage(params LoginParams) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<main class=\"flex justify-center px-5 py-12\"><div class=\"w-full max-w-xl grid gap-8\"><header class=\"grid gap-3\"><h1 class=\"text-3xl font-bold\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 string
			templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.heading"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 19, Col: 68}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "</h1><p class=\"opacity-70\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var4 string
			templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.requesting_access", params.ClientName))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 20, Col: 88}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "</p></header><div class=\"card bg-base-200 border border-base-300 shadow-xl\"><div class=\"card-body\"><h2 class=\"card-title text-xl\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var5 string
			templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.card_title"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 24, Col: 72}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "</h2><p class=\"opacity-70\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var6 string
			templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.card_subtitle"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 25, Col: 66}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "</p>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if params.Error != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<div class=\"alert alert-error mt-4\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var7 string
				templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(params.Error)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 27, Col: 57}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "</div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<div id=\"passkey-error\" class=\"alert alert-error mt-4\" hidden></div><div id=\"register-error\" class=\"alert alert-error mt-4\" hidden></div><div id=\"register-success\" class=\"alert alert-success mt-4\" hidden></div><form class=\"grid gap-4 mt-4\" id=\"register-form\"><label class=\"form-control w-full\"><div class=\"label\"><span class=\"label-text\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var8 string
			templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.email"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 34, Col: 82}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "</span></div><input type=\"email\" id=\"email\" name=\"email\" autocomplete=\"email\" required class=\"input input-bordered w-full\"></label> <button type=\"button\" class=\"btn btn-primary\" id=\"passkey-register\" data-pending-id=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var9 string
			templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(params.PendingID)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 37, Col: 109}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var10 string
			templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.create_passkey"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 37, Col: 151}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "</button></form><div class=\"divider\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var11 string
			templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.divider"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 39, Col: 59}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "</div><button type=\"button\" class=\"btn btn-outline\" id=\"passkey-login\" data-pending-id=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var12 string
			templ_7745c5c3_Var12, templ_7745c5c3_Err = templ.JoinStringErrs(params.PendingID)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 40, Col: 105}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var12))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var13 string
			templ_7745c5c3_Var13, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.sign_in_passkey"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 40, Col: 148}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var13))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "</button></div></div></div></main><div id=\"i18n-strings\" hidden data-missing-session=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var14 string
			templ_7745c5c3_Var14, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.missing_session"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 48, Col: 67}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var14))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "\" data-passkey-failed=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var15 string
			templ_7745c5c3_Var15, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.passkey_failed"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 49, Col: 65}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var15))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "\" data-email-required=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var16 string
			templ_7745c5c3_Var16, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.email_required"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 50, Col: 65}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var16))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "\" data-passkey-created=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var17 string
			templ_7745c5c3_Var17, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.passkey_created"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 51, Col: 67}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var17))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "\" data-register-failed=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var18 string
			templ_7745c5c3_Var18, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.register_failed"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 52, Col: 67}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var18))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 19, "\" data-login-start-error=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var19 string
			templ_7745c5c3_Var19, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.login_start_error"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 53, Col: 71}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var19))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 20, "\" data-login-finish-error=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var20 string
			templ_7745c5c3_Var20, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.login_finish_error"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 54, Col: 73}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var20))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 21, "\" data-register-start-error=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var21 string
			templ_7745c5c3_Var21, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.register_start_error"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 55, Col: 77}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var21))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 22, "\" data-register-finish-error=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var22 string
			templ_7745c5c3_Var22, templ_7745c5c3_Err = templ.JoinStringErrs(T(params.Loc, "login.js.register_finish_error"))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/services/web/templates/login.templ`, Line: 56, Col: 79}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var22))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 23, "\"></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = loginScript().Render(ctx, templ_7745c5c3_Buffer)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = ShellLayout(T(params.Loc, "title.login"), params.Lang, params.Loc).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// loginScript emits the client-side passkey JS.
func loginScript() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var23 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var23 == nil {
			templ_7745c5c3_Var23 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 24, "<script>\n\t\tconst i18nEl = document.getElementById(\"i18n-strings\");\n\t\tconst i18n = i18nEl ? i18nEl.dataset : {};\n\n\t\tconst passkeyButton = document.getElementById(\"passkey-login\");\n\t\tconst passkeyError = document.getElementById(\"passkey-error\");\n\t\tconst registerButton = document.getElementById(\"passkey-register\");\n\t\tconst registerEmail = document.getElementById(\"email\");\n\t\tconst registerError = document.getElementById(\"register-error\");\n\t\tconst registerSuccess = document.getElementById(\"register-success\");\n\n\t\tfunction showPasskeyError(message) {\n\t\t\tif (!passkeyError) return;\n\t\t\tpasskeyError.textContent = message;\n\t\t\tpasskeyError.hidden = false;\n\t\t}\n\n\t\tfunction showRegisterError(message) {\n\t\t\tif (!registerError) return;\n\t\t\tregisterError.textContent = message;\n\t\t\tregisterError.hidden = false;\n\t\t}\n\n\t\tfunction showRegisterSuccess(message) {\n\t\t\tif (!registerSuccess) return;\n\t\t\tregisterSuccess.textContent = message;\n\t\t\tregisterSuccess.hidden = false;\n\t\t}\n\n\t\tfunction bufferToBase64Url(buffer) {\n\t\t\tconst bytes = new Uint8Array(buffer);\n\t\t\tlet binary = \"\";\n\t\t\tbytes.forEach((b) => binary += String.fromCharCode(b));\n\t\t\treturn btoa(binary).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n\t\t}\n\n\t\tfunction base64UrlToBuffer(base64Url) {\n\t\t\tconst base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n\t\t\tconst pad = base64.length % 4 ? \"=\".repeat(4 - (base64.length % 4)) : \"\";\n\t\t\tconst binary = atob(base64 + pad);\n\t\t\tconst bytes = new Uint8Array(binary.length);\n\t\t\tfor (let i = 0; i < binary.length; i += 1) {\n\t\t\t\tbytes[i] = binary.charCodeAt(i);\n\t\t\t}\n\t\t\treturn bytes.buffer;\n\t\t}\n\n\t\tfunction credentialToJSON(credential) {\n\t\t\tif (!credential) return null;\n\t\t\tconst response = credential.response;\n\t\t\tconst data = {\n\t\t\t\tid: credential.id,\n\t\t\t\trawId: bufferToBase64Url(credential.rawId),\n\t\t\t\ttype: credential.type,\n\t\t\t};\n\t\t\tif (response) {\n\t\t\t\tdata.response = {\n\t\t\t\t\tclientDataJSON: bufferToBase64Url(response.clientDataJSON),\n\t\t\t\t\tattestationObject: response.attestationObject ? bufferToBase64Url(response.attestationObject) : undefined,\n\t\t\t\t\tauthenticatorData: response.authenticatorData ? bufferToBase64Url(response.authenticatorData) : undefined,\n\t\t\t\t\tsignature: response.signature ? bufferToBase64Url(response.signature) : undefined,\n\t\t\t\t\tuserHandle: response.userHandle ? bufferToBase64Url(response.userHandle) : undefined,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn data;\n\t\t}\n\n\t\tfunction normalizeRequestOptions(options) {\n\t\t\tconst publicKey = options;\n\t\t\tpublicKey.challenge = base64UrlToBuffer(publicKey.challenge);\n\t\t\tif (Array.isArray(publicKey.allowCredentials)) {\n\t\t\t\tpublicKey.allowCredentials = publicKey.allowCredentials.map((cred) => ({\n\t\t\t\t\t...cred,\n\t\t\t\t\tid: base64UrlToBuffer(cred.id),\n\t\t\t\t}));\n\t\t\t}\n\t\t\treturn publicKey;\n\t\t}\n\n\t\tfunction normalizeCreationOptions(options) {\n\t\t\tconst publicKey = options;\n\t\t\tpublicKey.challenge = base64UrlToBuffer(publicKey.challenge);\n\t\t\tif (publicKey.user && publicKey.user.id) {\n\t\t\t\tpublicKey.user.id = base64UrlToBuffer(publicKey.user.id);\n\t\t\t}\n\t\t\tif (Array.isArray(publicKey.excludeCredentials)) {\n\t\t\t\tpublicKey.excludeCredentials = publicKey.excludeCredentials.map((cred) => ({\n\t\t\t\t\t...cred,\n\t\t\t\t\tid: base64UrlToBuffer(cred.id),\n\t\t\t\t}));\n\t\t\t}\n\t\t\treturn publicKey;\n\t\t}\n\n\t\tasync function startPasskeyLogin(pendingId) {\n\t\t\tconst response = await fetch(\"/passkeys/login/start\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\"Content-Type\": \"application/json\"},\n\t\t\t\tbody: JSON.stringify({pending_id: pendingId}),\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(i18n.loginStartError || \"\");\n\t\t\t}\n\t\t\treturn response.json();\n\t\t}\n\n\t\tasync function finishPasskeyLogin(pendingId, sessionId, credential) {\n\t\t\tconst response = await fetch(\"/passkeys/login/finish\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\"Content-Type\": \"application/json\"},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tpending_id: pendingId,\n\t\t\t\t\tsession_id: sessionId,\n\t\t\t\t\tcredential,\n\t\t\t\t}),\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(i18n.loginFinishError || \"\");\n\t\t\t}\n\t\t\treturn response.json();\n\t\t}\n\n\t\tasync function startPasskeyRegister(email, pendingId) {\n\t\t\tconst response = await fetch(\"/passkeys/register/start\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\"Content-Type\": \"application/json\"},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\temail,\n\t\t\t\t\tpending_id: pendingId,\n\t\t\t\t}),\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(i18n.registerStartError || \"\");\n\t\t\t}\n\t\t\treturn response.json();\n\t\t}\n\n\t\tasync function finishPasskeyRegister(sessionId, userId, credential, pendingId) {\n\t\t\tconst response = await fetch(\"/passkeys/register/finish\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\"Content-Type\": \"application/json\"},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tsession_id: sessionId,\n\t\t\t\t\tuser_id: userId,\n\t\t\t\t\tcredential,\n\t\t\t\t\tpending_id: pendingId,\n\t\t\t\t}),\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(i18n.registerFinishError || \"\");\n\t\t\t}\n\t\t\treturn response.json();\n\t\t}\n\n\t\tasync function performPasskeyLogin(pendingId) {\n\t\t\tconst start = await startPasskeyLogin(pendingId);\n\t\t\tconst publicKey = normalizeRequestOptions(start.public_key.publicKey);\n\t\t\tconst assertion = await navigator.credentials.get({publicKey});\n\t\t\tconst credentialJSON = credentialToJSON(assertion);\n\t\t\tconst finish = await finishPasskeyLogin(pendingId, start.session_id, credentialJSON);\n\t\t\tif (finish.redirect_url) {\n\t\t\t\twindow.location = finish.redirect_url;\n\t\t\t}\n\t\t}\n\n\t\t\t\tif (passkeyButton && window.PublicKeyCredential) {\n\t\t\t\t\tpasskeyButton.addEventListener(\"click\", async () => {\n\t\t\t\t\t\tpasskeyError.hidden = true;\n\t\t\t\t\t\tconst pendingId = passkeyButton.dataset.pendingId;\n\t\t\t\t\t\tif (!pendingId) {\n\t\t\t\t\t\t\tshowPasskeyError(i18n.missingSession || \"\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait performPasskeyLogin(pendingId);\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tshowPasskeyError(err.message || i18n.passkeyFailed || \"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (registerButton && window.PublicKeyCredential) {\n\t\t\t\t\t\tregisterButton.addEventListener(\"click\", async () => {\n\t\t\t\tregisterError.hidden = true;\n\t\t\t\tregisterSuccess.hidden = true;\n\t\t\t\tconst pendingId = registerButton.dataset.pendingId || \"\";\n\t\t\t\t\t\tconst email = registerEmail ? registerEmail.value.trim() : \"\";\n\t\t\t\t\t\tif (!email) {\n\t\t\t\t\t\t\tshowRegisterError(i18n.emailRequired || \"\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tconst start = await startPasskeyRegister(email, pendingId);\n\t\t\t\t\tconst publicKey = normalizeCreationOptions(start.public_key.publicKey);\n\t\t\t\t\tconst credential = await navigator.credentials.create({publicKey});\n\t\t\t\t\tconst credentialJSON = credentialToJSON(credential);\n\t\t\t\t\tawait finishPasskeyRegister(start.session_id, start.user_id, credentialJSON, pendingId);\n\t\t\t\t\t\t\tif (pendingId) {\n\t\t\t\t\t\t\t\tawait performPasskeyLogin(pendingId);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tshowRegisterSuccess(i18n.passkeyCreated || \"\");\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tshowRegisterError(err.message || i18n.registerFailed || \"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
