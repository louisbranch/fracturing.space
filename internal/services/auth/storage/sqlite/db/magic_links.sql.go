// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: magic_links.sql

package db

import (
	"context"
	"database/sql"
)

const getMagicLink = `-- name: GetMagicLink :one
SELECT token, user_id, email, pending_id, created_at, expires_at, used_at FROM magic_links WHERE token = ?
`

func (q *Queries) GetMagicLink(ctx context.Context, token string) (MagicLink, error) {
	row := q.db.QueryRowContext(ctx, getMagicLink, token)
	var i MagicLink
	err := row.Scan(
		&i.Token,
		&i.UserID,
		&i.Email,
		&i.PendingID,
		&i.CreatedAt,
		&i.ExpiresAt,
		&i.UsedAt,
	)
	return i, err
}

const markMagicLinkUsed = `-- name: MarkMagicLinkUsed :exec
UPDATE magic_links SET used_at = ? WHERE token = ?
`

type MarkMagicLinkUsedParams struct {
	UsedAt sql.NullInt64 `json:"used_at"`
	Token  string        `json:"token"`
}

func (q *Queries) MarkMagicLinkUsed(ctx context.Context, arg MarkMagicLinkUsedParams) error {
	_, err := q.db.ExecContext(ctx, markMagicLinkUsed, arg.UsedAt, arg.Token)
	return err
}

const putMagicLink = `-- name: PutMagicLink :exec
INSERT INTO magic_links (
    token, user_id, email, pending_id, created_at, expires_at, used_at
) VALUES (?, ?, ?, ?, ?, ?, ?)
`

type PutMagicLinkParams struct {
	Token     string         `json:"token"`
	UserID    string         `json:"user_id"`
	Email     string         `json:"email"`
	PendingID sql.NullString `json:"pending_id"`
	CreatedAt int64          `json:"created_at"`
	ExpiresAt int64          `json:"expires_at"`
	UsedAt    sql.NullInt64  `json:"used_at"`
}

func (q *Queries) PutMagicLink(ctx context.Context, arg PutMagicLinkParams) error {
	_, err := q.db.ExecContext(ctx, putMagicLink,
		arg.Token,
		arg.UserID,
		arg.Email,
		arg.PendingID,
		arg.CreatedAt,
		arg.ExpiresAt,
		arg.UsedAt,
	)
	return err
}
